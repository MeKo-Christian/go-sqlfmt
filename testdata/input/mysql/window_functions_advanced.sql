SELECT employee_id,department,salary,hire_date,ROW_NUMBER() OVER(PARTITION BY department ORDER BY salary DESC) AS dept_salary_rank,RANK() OVER(PARTITION BY department ORDER BY salary DESC) AS dept_salary_rank_dense,DENSE_RANK() OVER(PARTITION BY department ORDER BY salary DESC) AS dept_salary_rank_no_gaps,PERCENT_RANK() OVER(PARTITION BY department ORDER BY salary DESC) AS dept_salary_percentile,CUME_DIST() OVER(PARTITION BY department ORDER BY salary DESC) AS dept_salary_cumulative_dist,NTILE(4) OVER(PARTITION BY department ORDER BY salary DESC) AS dept_salary_quartile,LAG(salary,1,0) OVER(PARTITION BY department ORDER BY hire_date) AS prev_salary_by_hire,LEAD(salary,1,0) OVER(PARTITION BY department ORDER BY hire_date) AS next_salary_by_hire,FIRST_VALUE(salary) OVER(PARTITION BY department ORDER BY hire_date ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS first_hired_salary,LAST_VALUE(salary) OVER(PARTITION BY department ORDER BY hire_date ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS last_hired_salary,NTH_VALUE(salary,2) OVER(PARTITION BY department ORDER BY hire_date ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS second_hired_salary FROM employees WHERE active=1 ORDER BY department,hire_date;